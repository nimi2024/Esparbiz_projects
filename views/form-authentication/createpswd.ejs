<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> FORGET PASSWORD</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="/styles/form-authentication.css">
  </head>
<body>
  <form action="/create-password" method="post" id="create-password" >
      <section class="h-100 bg-dark">
        <div class="container py-5 h-100">
          <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col">
              <div class="card card-registration my-4">
                <div class="row g-0">
                  <div class="col-xl-6 d-none d-xl-block">
                    <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-registration/img4.webp"
                      alt="Sample photo" class="img-fluid"
                      style="border-top-left-radius: .25rem; border-bottom-left-radius: .25rem;" />
                  </div>
                  <div class="col-xl-6">
                    <div class="card-body p-md-5 text-black">
                      <h3 class="mb-5 text-uppercase"> Create Password</h3>


                      <div class="form-outline mb-4">
                        <input type="password" id="password" name="password" class="form-control form-control-lg" required/>
                        <label class="form-label" for="password" name="password">Password:</label>
                      </div>

                      <div class="form-outline mb-4">
                        <input type="password" id="rpassword" name="prassword" class="form-control form-control-lg" required/>
                        <label class="form-label" for="password" name="repeatpassword">Repeat Password:</label>
                      </div>
      
                      <div class="d-flex justify-content-end pt-3">
                     
                        <a class="btn btn-warning btn-lg ms-2"  onclick="redirectToPage()" target="_blank" id="createpswd-btn" name="submit">submit</a>
                        <a class="btn btn-primary btn btn-warning btn-lg ms-2" target="_blank" href="http://localhost:3000/">HOME</a>
                      
                        
                      </div>
                      <div id="output"></div>
      
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </form>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <script>
   
   console.log("!!sinchen.....");
document.getElementById('createpswd-btn').addEventListener('click', async () => {

    const formData = new FormData(document.getElementById('create-password'));
    console.log('formdata', formData);
    const data = {};
    for (const [key, value] of formData.entries()) {
        data[key] = value;
        console.log( "data is....",data)
    }
    console.log("data is:", data)



    try {
        
        const response = await fetch('/create-password', {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                Accept: "application/json",
            },
            body: JSON.stringify(data)

        })
        console.log('data fetching')
        const result = await response.json();
        const outputDiv = document.getElementById('output');
        outputDiv.innerHTML = `<p> server response: ${result.message}</p>`;

    } catch (error) {
        console.log("Error fetching data:", error);
        const outputDiv = document.getElementById('output');
        // outputDiv.style.color="red";
        // outputDiv.style.fontWeight="bolder";
        //  outputDiv.innerHTML = '<p> Error fetching data. please try again.</p>'
        
    }
}

);

function redirectToPage(){
    window.location.href='http://localhost:3000/showResponse'
 }

  </script>
</body>
</html>